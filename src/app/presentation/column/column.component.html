<header>
  <div class="column-title">{{ status() }}</div>
  @if (displayStatusPicker()) {
    <button class="status-trigger" [menuTriggerFor]="statusMenu">
      <app-icon icon="caret-down"></app-icon>
    </button>
  }
</header>

@if (!editableTaskDisplayed()) {
  <button type="button" class="add" (click)="editableTaskDisplayed.set(true)">
    + Ajouter une t√¢che
  </button>
}
<ul id="{{ status() }}" cdkDropList class="tasks" (cdkDropListDropped)="drop($event)">
  @if (editableTaskDisplayed()) {
    <li
      app-editable-task
      (created)="addTask($event)"
      (canceled)="editableTaskDisplayed.set(false)"
    ></li>
  }
  @for (task of tasks; track task.id) {
    <li
      app-task
      [task]="task"
      cdkDrag
      [cdkDragData]="task"
      (prorityChanged)="updateTaskPriority($event, task.id)"
      (statusChanged)="updateTaskStatus($event, task.id)"
      (deleted)="deleteTask(task.id)"
    ></li>
  }
</ul>

<ng-template #statusMenu>
  <ul class="menu">
    @for (choice of statusChoices; track choice) {
      <li menuItem class="menu-item" (click)="changeStatus(choice)">{{ choice }}</li>
    }
  </ul>
</ng-template>
